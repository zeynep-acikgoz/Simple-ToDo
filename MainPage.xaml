<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:CetTodoApp"
             x:Class="CetTodoApp.MainPage">

    <ContentPage.Resources>
        <local:OverdueColorConverter x:Key="OverdueColorConverter" />
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto, *" Padding="20" Margin="20">
       
       <Border Grid.Row="0" Margin="0,0,0,10" StrokeShape="RoundRectangle 10">
           <VerticalStackLayout Margin="10" Padding="10">
               <Entry x:Name="Title" Placeholder="Enter a todo Item" />
               <HorizontalStackLayout Padding="20" Margin="10">
                    <Label Text="Due Date :" VerticalOptions="Center"></Label>
                    <DatePicker x:Name="DueDate" VerticalOptions="Center" ></DatePicker>
               </HorizontalStackLayout>
               <Button x:Name="AddButton" Text="Save" Clicked="AddButton_OnClicked"></Button>
           </VerticalStackLayout>
       </Border>

       <ListView x:Name="TasksListView" 
                 Grid.Row="1"
                 ItemSelected="TasksListView_OnItemSelected"
                 HasUnevenRows="True">
           
           <ListView.ItemTemplate>
               <DataTemplate>
                   <ViewCell>
                       <StackLayout Orientation="Horizontal" Padding="10">
                           
                           <Label Text="{Binding Title}"   
                                  VerticalOptions="Center"
                                  FontSize="16">
                               <Label.Triggers>
                                   <DataTrigger TargetType="Label" Binding="{Binding IsComplete}" Value="True">
                                       <Setter Property="TextDecorations" Value="Strikethrough"/>
                                       <Setter Property="TextColor" Value="Gray"/>
                                   </DataTrigger>
                               </Label.Triggers>
                           </Label> 
                           
                           <Label Text="{Binding DueDate, StringFormat=' (Due: {0:dd/MM})'}"
                                  VerticalOptions="Center"
                                  TextColor="{Binding DueDate, Converter={StaticResource OverdueColorConverter}}">
                               <Label.Triggers>
                                   <DataTrigger TargetType="Label" Binding="{Binding IsComplete}" Value="True">
                                       <Setter Property="TextColor" Value="Gray"/>
                                       <Setter Property="TextDecorations" Value="Strikethrough"/>
                                   </DataTrigger>
                               </Label.Triggers>
                           </Label>
                           
                           <CheckBox VerticalOptions="Center" 
                                     HorizontalOptions="EndAndExpand"
                                     IsChecked="{Binding IsComplete}" 
                                     IsEnabled="False" >
                           </CheckBox>
                         
                       </StackLayout>
                   </ViewCell>
               </DataTemplate>
           </ListView.ItemTemplate>
       </ListView>
       
   </Grid>

</ContentPage>